<!DOCTYPE html><!--[if lte IE 8]>
<html lang="en" class="lte-ie8">
<![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en">
<!--<![endif]--><head><meta charset="utf-8"><title>October 19, 2015</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/diary/styles/global.css"><link rel="stylesheet" href="/diary/styles/tomorrow.css"><link rel="stylesheet" href="/diary/styles/diary.css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-63818301-1', 'auto');
ga('send', 'pageview');</script></head><body><header class="header"><div class="index"><a href="/diary/">Index</a></div><h1>October 19, 2015</h1></header><div class="content"><div class="diary"><h2 id="c-">C++</h2>
<h3 id="the-mythical-performance-of-cout-">The mythical performance of <code>cout</code></h3>
<p>Source: <a href="https://gcc.gnu.org/onlinedocs/libstdc++/manual/io_and_c.html">Interacting with C</a></p>
<p>First of all, overloading <code>&lt;&lt;</code> for different types can happen at compile time via parametric polymorphism, so this won&#39;t be an issue.</p>
<p>An important part of the runtime cost comes with synchronization with stdio. Think about this code:</p>
<pre><code class="lang-cpp"><span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span>

<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"Hel"</span>;
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">printf</span> (<span class="hljs-string">"lo, worl"</span>);
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"d!\n"</span>;
</code></pre>
<p>The strings must be printed out in the right order, so <code>cout</code>&#39;s buffer must be kept in sync with <code>printf</code>&#39;s. In libstdc++ v3.0, C++ I/O library in layered on top of C I/O library by default, so the <code>iostream</code>s has very little buffering(most of the buffering is in the underlying C library). This makes the <code>iostream</code>s very slow.</p>
<p>If you only uses C++ I/O, use <code>std::ios::sync_with_stdio(false);</code> then gcc will fully buffer <code>cout</code> and other streams on their own.</p>
<p>Note: file streams will always be fully buffered, so don&#39;t worry about that.</p>
<h3 id="-why-should-i-use-iostream-instead-of-the-traditional-cstdio-https-isocpp-org-wiki-faq-input-output-iostream-vs-stdio-"><a href="https://isocpp.org/wiki/faq/input-output#iostream-vs-stdio">Why should I use <code>&lt;iostream&gt;</code> instead of the traditional <code>&lt;cstdio&gt;</code>?</a></h3>
<ul>
<li>The type of object being I/O&#39;d will be known statically by the compiler</li>
<li>No more <code>%</code>, less confusion, less error</li>
<li>You can overload <code>&lt;&lt;</code>/<code>&gt;&gt;</code> for user-defined type</li>
<li>They are inheritable(hmmmm...I don&#39;t really think that&#39;s a good idea)</li>
</ul>
</div></div><footer class="footer"><address class="author">Copyright &copy;<a rel="author" href="https://github.com/joyeecheung" class="author-name">Joyee Cheung</a>-<a href="https://github.com/joyeecheung/my-tech-diary" class="source-repo">Source</a></address><p>Generated by<a href="https://github.com/joyeecheung/diary" class="site-repo">Joyee Cheung&#39;s diary generator</a></p></footer></body></html>