<!DOCTYPE html><!--[if lte IE 8]>
<html lang="en" class="lte-ie8">
<![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en">
<!--<![endif]--><head><meta charset="utf-8"><title>October 2, 2015</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/diary/styles/global.css"><link rel="stylesheet" href="/diary/styles/tomorrow.css"><link rel="stylesheet" href="/diary/styles/diary.css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-63818301-1', 'auto');
ga('send', 'pageview');</script></head><body><header class="header"><div class="index"><a href="/diary/">Index</a></div><h1>October 2, 2015</h1></header><div class="content"><div class="diary"><h2 id="js">JS</h2>
<h3 id="-philip-roberts-what-the-heck-is-the-event-loop-anyway-jsconf-eu-2014-youtube-https-www-youtube-com-watch-v-8aghzqkofbq-"><a href="https://www.youtube.com/watch?v=8aGhZQkoFbQ">Philip Roberts: What the heck is the event loop anyway? | JSConf EU 2014 - YouTube</a></h3>
<ul>
<li>The event loop, the task queue and the Web APIs(e.g. <code>setTimeout</code>) have nothing to do with the JS engine itself</li>
<li>When you call <code>setTimeout</code>, the callback(and the context) along with the timer will be passed (from the call stack) to the API. Then the time is up, the callback(and the context) will be put into the <strong>task queue</strong></li>
<li>The job of the event loop is to look at the task queue and the call stack. Whenever the call stack is empty, it will pop from the task queue(if it&#39;s not empty), and put the front-most thing into the call stack for execution</li>
<li><code>setTimeout(cb, 0)</code> will get the callback in the task queue immediately, but the event loop will wait until the call stack is clear before pull the callback out and put it on the call stack(don&#39;t forget about the caller function/&quot;main&quot; function could be still on the stack).</li>
<li><p>Async iteration</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asyncForEach</span>(<span class="hljs-params">array, cb</span>) </span>{
  array.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    setTimeout(cb, <span class="hljs-number">0</span>);
  });
}
</code></pre>
</li>
<li>The rendering will have to wait for the call stack to clear, but it has a high priority on the task queue. So doing things asynchronously(by putting them on the task queue), the browser will have the chance to render the page timely. This is important when doing animations, especially for scrolling, etc.</li>
</ul>
</div></div><footer class="footer"><address class="author">Copyright &copy;<a rel="author" href="https://github.com/joyeecheung" class="author-name">Joyee Cheung</a>-<a href="https://github.com/joyeecheung/my-tech-diary" class="source-repo">Source</a></address><p>Generated by<a href="https://github.com/joyeecheung/diary" class="site-repo">Joyee Cheung&#39;s diary generator</a></p></footer></body></html>